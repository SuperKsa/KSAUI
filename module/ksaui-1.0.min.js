/*
 * KSAUI 前端UI组件库 V1.0
 *
 * 目前版本还处于开发中，请勿保存并用于生产环境！
 *  * ---------------------------------------
 * 待正式发布版本后，源代码将会公开开源
 *
 * @Author: cr180(cr180.com & ksaOS.com)
 * @Date: 2017-06-12 01:24:09
 * @LastEditors: CR180
 * @LastEditTime: 2020-08-23 17:25:34
 * @Description: file content
 */
$.ZINDEX=999;$.WINID=1;$.W=0;$.H=0;$.mouseX=0;$.mouseY=0;$.device="PC";$.deviceView=0;$.ksauiRenderTree={};(function(d){function u(a,b,c){var e="",f=d.isArray(a);d.loop(a.option,function(a,k){if(a.option)e+='\x3cks-list-item class\x3d"ks-select-optgroup-title"\x3e\x3cstrong\x3e'+a.label+"\x3c/strong\x3e"+u(a,b,c)+"\x3c/ks-list-item\x3e";else{d.isObject(a)||(a={value:f?a:k,label:a});b&&d.inArray(a.value,b)&&(a.selected=!0);a.selected||(a.selected=null);var g=d.isset(a.label)?a.label:a.content;delete a.content;e+=d.tag("ks-list-item",a,g)}});return'\x3cks-list class\x3d"ks-list-select" '+(c?' multiple\x3d"multiple"':"")+"\x3e"+e+"\x3c/ks-list\x3e"}function v(a,b,c){c=c||0;a=d(a);b=0===c?a.val():b;var e=a.attr()||{};e.option=[];a.children().map(function(a){var f;"OPTGROUP"==a.tagName?f=v(a,b,c):(f=d(a).attr()||{},f.n=c,f.selected=!!a.selected,f.content=a.text,c++);e.option.push(f)});return e}function x(a){a=d(a);var b=a.attr(),c=d(a).wrap(d.tag("ks-input-group",{"class":b["class"],id:b.id}));b.icon&&a.before("\x3ci\x3e"+b.icon+"\x3c/i\x3e");b.label&&a.before("\x3ci\x3e"+b.label+"\x3c/i\x3e");b.unit&&a.after("\x3ci\x3e"+b.unit+"\x3c/i\x3e");a.attr({"class":"",id:"",icon:""});return c}var y=navigator.userAgent;d.IE=function(){var a=y.match(/msie\s([\d.]+)/i),d=y.match(/trident\/([\d.]+)/i);return parseInt(a&&a[1]?a[1]:d&&d[1]?"11":"0")}();0<d.IE&&d("html").addClass("ks-ie"+d.IE+" ks-ie");d.isMobile=!1;d.isWechat=!1;d.W=window.innerWidth;d.H=window.innerHeight;var w=navigator.userAgent.toLowerCase();if(/android|ipad|iphone/.test(w)||/mac os/.test(w)&&d.W<d.H)d.device="MOBILE",d.isMobile=!0,d("html").attr("mobile","true").attr("device","mobile"),d.isWechat=/microMessenger/i.test(w);"PC"==d.device&&(d(document).on("mousemove",function(a){d.mouseX=a.x||a.layerX||0;d.mouseY=a.y||a.layerY||0}),d("html").attr("device","pc"));d(window).resize(function(){d.W=window.innerWidth;d.H=window.innerHeight});d.render=function(a,b,c){var e=[];d.loop(d.explode(" ",c),function(a){(a=d.trim(a))&&e.push(a)});d.isObject(a)&&!b?d.loop(a,function(a,c){d.ksauiRenderTree[c]={callback:a,monitor:e}}):d.ksauiRenderTree[a]={callback:b,monitor:e}};d.BackEvent=function(a,b){var c=this;c.BackEventData=c.BackEventData?c.BackEventData:{};c.BackEventData.doms=c.BackEventData.doms?c.BackEventData.doms:{};var e=window.location.href,f="#"+a;if(b)-1==e.indexOf(f)&&(location.hash+=f),c.BackEventData.doms[a]=b,c.BackEventData.init||(c.BackEventData.init=1,d(window).on("popstate",function(){var a=window.location.href.indexOf("#"),a=-1==a?"":window.location.href.substr(a),b={};d.loop(d.explode("#",a),function(a){a&&(b[a]=a)});var f={};d.loop(c.BackEventData.doms,function(a,c){b[c]?f[c]=a:d.layerHide(d(a).attr("key"))});c.BackEventData.doms=f}));else if(-1!=e.indexOf(f)){var g={};d.loop(c.BackEventData.doms,function(d,c){c!=a&&(g[c]=d)});c.BackEventData.doms=g;window.history.go(-1)}};d.resize=function(a,b){var c=this;1==b||3==b?a(window.innerWidth,window.innerHeight):2!=b&&3!=b||d(document).ready(function(){a(window.innerWidth,window.innerHeight)});d(window).resize(function(){a&&"function"==typeof a&&a(window.innerWidth,window.innerHeight);c.deviceView=typeof window.orientation&&d.inArray(window.orientation,[0,-90])?0:1})};d.Cache=function(a,b,c){var e=Math.round((new Date).getTime()/1E3);if("undefined"!==typeof Storage){if("string"!==typeof b||b){if("undefined"!==typeof b)return"object"===typeof b&&(b=JSON.stringify(b),localStorage.setItem(a+"_jsjson",1)),localStorage.setItem(a,b),(c=parseInt(c))&&localStorage.setItem(a+"_Expired",e+c),d.Cache(a);if((b=localStorage.getItem(a+"_Expired"))&&b<e)return;b=localStorage.getItem(a);"1"==localStorage.getItem(a+"_jsjson")&&(b=JSON.parse(b));return b}localStorage.removeItem(a);localStorage.removeItem(a+"_jsjson");localStorage.removeItem(a+"_Expired");return!0}};d.Position=function(a,b){a=d(a);b=d(b);var c={left:a.offset().left,top:a.offset().top+a.height(!0)};c.left>this.W-b.width(!0)&&(c.left=c.left-b.width(!0)-a.height(!0));c.top>this.H-b.height(!0)&&(c.top=c.top-b.height(!0)-a.height(!0));b.css(c)};d.layerHideF=function(){if(typeof window.parent){var a=d("body").attr("parentlayerid");a&&window.parent.$.layerHide(a)}};d.layerHide=function(a,b){d("body").removeClass("ks-body-layer-overflow");var c;if(a&&(c=d("#ks-layer-"+a),c.length)){var e=t[a]?t[a].option:{};if(a){var f=c.next('[data-layer-key\x3d"'+a+'"]');c.addClass("ks-anim-hide");f.addClass("ks-anim-fadeout");(void 0===d.layerHideBackEvent||d.layerHideBackEvent)&&e.backEvent&&d.BackEvent("KsaLayer"+a);setTimeout(function(){c.active(!1);b&&b(a);!e.cancel&&e.close&&e.close();e.hide&&e.hide();e.cache?(f.length&&f.hide(),c.hide()):(f.length&&f.remove(),c.remove(),delete t[a])},200)}}};var t={};d.layer=function(a,b,c,e,f,g,k){var h=d(a.el||"body");h.offset();var m=h.width(!0);h.height(!0);var l={0:"ks-anim-up",1:"ks-anim-right",2:"ks-anim-down",3:"ks-anim-left",4:"ks-anim-right",5:"ks-anim-scale",6:"ks-anim-left",7:"ks-anim-right",8:"ks-anim-up",9:"ks-anim-left","00":"ks-anim-left"};return{ID:1,layer:null,obj:{},isCache:!1,autoCloseObj:null,init:function(){var c=this;a.cache&&d.loop(t,function(b){b.cache===a.cache&&(c.obj=b,c.isCache=!0,c.layer=d(c.obj.dom))});c.optionInit();!c.isCache&&c.createDom();c.sizeInit();this.show();!c.isCache&&a.ajaxUrl&&d.API(a.ajaxUrl,a.ajaxPost,function(d){c.layer.children(".ks-layer-content").html(d);a.ajaxCall&&a.ajaxCall.call(c.layer,c.layer.children(".ks-layer-content").children("*"));window.setTimeout(function(){c.pos()})});return this.obj},optionInit:function(){if("string"==typeof a||a instanceof d&&a[0].innerHTML)a={content:a};a.ajaxUrl&&(a.content='\x3cdiv class\x3d"ks-loading"\x3e\x3c/div\x3e');a=d.arrayMerge({el:d.layerEL||"body",title:null,content:null,"class":"",iframe:null,ajaxUrl:null,ajaxPost:null,type:"",pos:b?b:5,btn:null,btnFun:g,cover:d.isset(c)?c:0,outTime:0,init:k,show:e,close:f,closeBtn:1,backEvent:null,cache:null,maxHeight:0,height:null},a);null===a.backEvent&&d.isMobile&&(a.backEvent=1);a.type=a.type?a["class"]+" "+a["class"]+"_"+a.type:"";a.cache=a.cache?a.cache:null;a.iframe&&(a["class"]+=" ks-layer-iframe",a.content='\x3cdiv class\x3d"ks-loading"\x3e\x3c/div\x3e\x3ciframe src\x3d"'+a.iframe+'" width\x3d"100%" height\x3d"100%"\x3e\x3c/iframe\x3e')},pos:function(){var c={},b=a.pos;this.countSize();var f=this.obj.width,e=this.obj.height;if(d.inArray(b,["00",1,2,3,4,5,6,7,8,9]))d.inArray(b,[1,4,7])&&(c.left=0),d.inArray(b,[1,2,3])&&(c.top=0),d.inArray(b,[2,5,8])&&(c["margin-left"]=d.intval(0-f/2)),d.inArray(b,[3,6,9])&&(c.right=0,c.left="initial"),d.inArray(b,[4,5,6])&&(c["margin-top"]=d.intval(0-e/2)),d.inArray(b,[7,8,9])&&(c.top="initial",c.bottom="0"),"00"==b&&(c.top="0",c.bottom="0",c["margin-left"]="-100%");else{var b=d(b),f=b.width(!0),g=b.height(!0),e=this.layer.width(!0),k=this.layer.height(!0);c.left=b.offset().left;c.top=b.offset().top+g;g=b.offset().top-d(document).scrollTop()+g+k;0>m-(c.left+e)&&(c.left=c.left-e+f);0>d.H-g?(c.top=b.offset().top-k,this.obj.pos=2):this.obj.pos=8}this.layer.css(c)},close:function(){this.autoCloseObj&&clearTimeout(this.autoCloseObj);d.layerHide(this.ID)},createDom:function(){var c=this,b=d.ZINDEX++,f="";a.closeBtn&&(f+='\x3cspan class\x3d"ks-layer-close" icon\x3d"close"\x3e\x3c/span\x3e');a.title&&(f+='\x3cdiv class\x3d"ks-layer-title"\x3e'+a.title+"\x3c/div\x3e");f+='\x3cdiv class\x3d"ks-layer-content"\x3e\x3c/div\x3e';if(a.btn){var e="";d.isString(a.btn)?e+=d.tag("ks-btn",{"data-btn-index":0},a.btn):d.loop(a.btn,function(a,c){a=a.split(":");e+=d.tag("ks-btn",{"class":"_"+c,"data-btn-index":c,color:a[1],cap:d.isMobile},a[0])});f+=e?'\x3cdiv class\x3d"ks-layer-bottom"\x3e'+e+"\x3c/div\x3e":""}var g=d.isObject(a.pos)?0:a.pos,f=d.tag("div",{"class":"ks-layer "+a["class"]+" "+a.type,pos:g,id:"ks-layer-"+b,style:"z-index:"+b,key:b},f),f=d(f);f.find(".ks-layer-content").html(a.content);t[b]=this.obj={dom:f[0],coverDom:"",id:b,selector:"#ks-layer-"+b,option:a,width:0,height:0,cache:a.cache,pos:g,resize:function(){c.pos()},close:function(){c.close()},show:function(){c.show()}};c.ID=b;c.layer=f;c.layer.layerID=b;d(h).append(f);a.iframe&&(f.iframe=null,f.find("iframe")[0].onload=function(){f.iframe=d(this.contentWindow.document.body);f.iframe.attr("parentlayerid",b);f.find(".ks-loading").remove()});a.closeBtn&&f.find(".ks-layer-close").click(function(){c.close()});a.btn&&f.find(".ks-layer-bottom \x3e ks-btn").click(function(){var b=d(this);b.disabled()||a.btnFun&&("function"!=typeof a.btnFun||!1===a.btnFun.call(c,b.data("btn-index"),f))||(a.cancel="cancel"===b.data("btn-index"),c.close())}).filter("ks-btn:last-child:not([color])").attr("color","primary");if(a.cover){g=d('\x3cdiv class\x3d"ks-layer-cover" data-layer-key\x3d"'+b+'" style\x3d"z-index: '+(b-1)+'"\x3e\x3c/div\x3e');c.obj.coverDom=g[0];g.css(d.arrayMerge({top:0,right:0,bottom:0,left:0},d.isObject(a.cover)?a.cover:{}));if(1<a.cover){var k=d.isMobile?"touchend":3==a.cover?"dblclick":2==a.cover?"click":"";k&&g.on(k,function(){c.close()})}c.layer.after(g)}f.layer=c;d.isFunction(a.init)&&a.init(f,b)},sizeInit:function(){var c={},b=d.H;a.title&&(b-=this.layer.children(".ks-layer-title").height(!0,!0));a.btn&&(b-=this.layer.children(".ks-layer-bottom").height(!0,!0));a.height&&(c.height=a.height,d.strpos(c.height,"%")&&(c.height=b*d.floatval(c.height)/100));a.maxHeight&&(c["max-height"]=a.maxHeight,d.isString(c["max-height"])&&c["max-height"].indexOf("%")&&(c["max-height"]=b*d.floatval(c["max-height"])/100));a.width&&(c.width=a.width,d.isString(c.width)&&c.width.indexOf("%")&&(c.width=d.floatval(c.width),c.width=m*c.width/100));this.layer.children(".ks-layer-content").css(c)},show:function(){var c=this,b=c.obj.pos,f=c.ID;d.isset(a.bodyOver)&&!a.bodyOver||d(h).addClass("ks-body-layer-overflow");this.layer.removeClass("ks-anim-hide").show();d(this.obj.coverDom).removeClass("ks-anim-fadeout").show();window.setTimeout(function(){l[b]&&c.layer.addClass(l[b]);c.layer.active(!0);a.backEvent&&d.BackEvent("KsaLayer"+f,"#ks-layer-"+f);d.isFunction(a.show)&&a.show(c.layer,f);0<a.outTime&&(c.autoCloseObj=setTimeout(function(){c.close()},1E3*a.outTime+50));c.pos();window.setTimeout(function(){c.pos()},200)});d(document).off("keydown.ks-layer").on("keydown.ks-layer",function(a){27==a.keyCode&&(a=d(".ks-layer").last(),a.length&&d.layerHide(a.attr("key")))});return c.layer},countSize:function(){this.obj.width=this.layer.width(!0);this.obj.height=this.layer.height(!0)}}.init()};d.Dialog=function(a){var b=arguments,c={"class":"ks-Dialog ks-Dialog"};switch(!0){case d.inArray(a,["success","error"]):c.content=b[1];c.close=b[2];c.btn=b[3]||{cancel:"\u77e5\u9053\u4e86:primary"};c["class"]+="_"+a;c.closeBtn=0;c.cover=2;c.backEvent=!1;break;case "confirm"==a:var e=b[4],f=b[3],e=e&&d.isString(e)?{confirm:e}:e||{cancel:"\u53d6\u6d88",confirm:"\u786e\u8ba4:primary"};c.title=b[1];c.content=b[2];c.close=null;c.btn=e;c.outTime=0;c.cover=1;c.maxWidth="80%";c.btnFun=function(a,c){if("confirm"==a&&"function"==typeof f)return f.apply(c,[c])};c["class"]+="_"+a;c.closeBtn=0;break;case "prompt"==a:f=b[4];c.title=b[1];var g=b[5]||0,e=["text","textarea","textarea","password"][g],k=d.inArray(g,[1,2]);k?c.content=d.tag(e,{type:"ks-"+e,placeholder:b[2],auto:2==g},b[3]):(c.content="",c.content+=d.tag("input",{type:"ks-"+e,placeholder:b[2],value:b[3]},"",!0),3==g&&(c.content+=d.tag("input",{type:"ks-"+e,placeholder:"\u518d\u6b21\u8f93\u5165\u65b0\u5bc6\u7801","class":"ks-mt3"},"",!0),c.content+=d.tag("input",{type:"ks-"+e,placeholder:"\u8bf7\u8f93\u5165\u65e7\u5bc6\u7801",name:"old",value:"","class":"ks-mt3"},"",!0)));c.close=null;c.btn={cancel:"\u53d6\u6d88",confirm:"\u786e\u8ba4:primary"};c.outTime=0;c.cover=1;c.maxWidth="80%";c.btnFun=function(a,c){if("confirm"==a&&"function"==typeof f){var b=c.find(k?"textarea":"input"),e=b.eq(0).val(),e=e?e:"";if(3==g){var h=b.eq(1).val();if(!e||!h||e!==h)return d.toast("\u8bf7\u8f93\u5165\u5bc6\u7801\uff0c\u4e14\u4e24\u6b21\u987b\u76f8\u540c"),!1;b=b.eq(2).val();return b?f.apply(this,[e,b,c]):(d.toast("\u8bf7\u8f93\u5165\u65e7\u5bc6\u7801"),!1)}return f.apply(this,[e,c])}};c["class"]+="_"+a;c.closeBtn=1;d.isMobile&&(c.pos="8");break;case "form"==a:var e=d.createForm(b[2]),h=b[2].confirm,f=b[3];c.title=b[1];c.content=e;c.close=null;c.btn={cancel:"\u53d6\u6d88",confirm:b[4]?b[4]:"\u786e\u8ba4"};c.outTime=0;c.cover=1;c.btnFun=function(a,c){function e(){if(b[2].action)return c.find("form").formSubmit(function(a,b){var e;f&&(e=f.apply(c,arguments));!1!==e&&b.success&&d.layerHide(c.layerID)}),!1;if(f)return f.apply(c,[c.find("form").formData(),c])}if("confirm"==a)return h?(h=!0===h?"\u786e\u8ba4\u8981\u8fdb\u884c\u8be5\u64cd\u4f5c\u5417\uff1f":h,d.Dialog("confirm",h,"",function(){e();return!0}),!1):e()};c["class"]+="_"+a;c.closeBtn=1;c.maxHeight="100%";c.show=function(a){a.find("form").submit(function(a){a.stop()})};c.pos=5;d.isMobile&&(c.pos=8,c.width="100%");break;case "smscode"==a:var m=b[2];c.title="\u8bf7\u8f93\u5165\u77ed\u4fe1\u9a8c\u8bc1\u7801";c.content="";b[1]&&(c.content+='\x3cdiv class\x3d"ks-mb"\x3e'+b[1]+"\x3c/div\x3e");c.content+='\x3cdiv\x3e\x3cks-input-group\x3e\x3cinput type\x3d"ks-text" name\x3d"code" value\x3d"" placeholder\x3d"\u8bf7\u8f93\u5165"\x3e\x3cks-btn\x3e\u91cd\u65b0\u53d1\u9001\x3c/ks-btn\x3e\x3c/ks-input-group\x3e\x3c/div\x3e';var l={};c.init=function(a){var c=a.find(".ks-layer-content ks-btn"),b=a.find("input[name\x3dcode]"),f=function(){c.disabled()||(c.disabled(!0).text("\u53d1\u9001\u4e2d"),d.API(m.api,m.post,function(d){if(d.success){b.val("");l=d;var f=d.sendTime;f--;c.disabled(!0).text("\u91cd\u65b0\u53d1\u9001("+f+"\u79d2)");a.layer.pos();var e=window.setInterval(function(){0===f?(window.clearInterval(e),c.disabled(!1).text("\u91cd\u65b0\u53d1\u9001"),a.layer.pos()):(f--,c.disabled(!0).text("\u91cd\u65b0\u53d1\u9001("+f+"\u79d2)"))},1E3)}else c.disabled(!1).text("\u91cd\u65b0\u53d1\u9001")},function(){c.disabled(!1).text("\u91cd\u65b0\u53d1\u9001")}))};c.click(f);f()};f=b[3];c.btn={cancel:"\u53d6\u6d88",confirm:"\u786e\u8ba4"};c.btnFun=function(a,c){var b=c.find("input[name\x3dcode]");if("confirm"==a&&"function"==typeof f)return l.code=b.val()||"",l.code?f.call(c,l):(d.toast("\u8bf7\u8f93\u5165\u77ed\u4fe1\u9a8c\u8bc1\u7801"),!1)};c.cover=1;break;default:c.title=b[0],c.content=b[1],c.outTime=b[2],c.btn=b[3],c.btnFun=b[4],c.close=b[5],c.cover=1,c.pos=5}return d.layer(c)};d.toast=function(a,b,c,e){d.toastHide();var f=0;e="undefined"==typeof e?2:e;"loading"==a&&(a="\u6570\u636e\u52a0\u8f7d\u4e2d",c=b,b="loading",e=0,f=1);b&&(a='\x3cdiv icon\x3d"'+b+'"\x3e'+a+"\x3c/div\x3e");return d.layer({content:a,"class":"ks-Dialog_toast",type:b,cover:f,close:c,outTime:e,backEvent:!1,bodyOver:!1,cancel:!1})};d.toastHide=function(){d(".ks-layer.ks-Dialog_toast + .ks-layer-cover").remove();d(".ks-layer.ks-Dialog_toast").remove()};d.openWindow=function(a){var b='\x3cdiv class\x3d"ks-hdbar"\x3e';if(null===a.backBtn||!1!==a.backBtn)b+='\x3cspan icon\x3d"back" onclick\x3d"window.history.go(-1);"\x3e\x3c/span\x3e';b+='\x3cdiv class\x3d"ks-hdbar-title"\x3e'+a.title+"\x3c/div\x3e";return this.layer(d.arrayMerge(a,{title:b+"\x3c/div\x3e",content:a.content||'\x3cdiv class\x3d"layer-loading"\x3e\x3ci icon\x3d"loading"\x3e\x3c/i\x3e\u52a0\u8f7d\u4e2d\x3c/div\x3e',width:"100%",height:"100%",maxHeight:!1,pos:"00","class":"openWindow"}))};d.times=function(a,b){d.isNumber(a)&&d.inArray(d.strlen(a),[10,13])&&(10==a.length&&(a*=1E3),a=parseInt(a));"string"==typeof a&&(a=a.replace(/\u5e74|\u6708/g,"-"),a=a.replace(/\u65f6|\u5206|\u70b9/g,":"),a=a.replace(/\u65e5|\u79d2/g,""));var c=a?new Date(a):new Date,e={Y:c.getFullYear(),m:c.getMonth()+1,d:c.getDate(),H:c.getHours(),i:c.getMinutes(),s:c.getSeconds(),str:"",timestamp:c.getTime()};e.str=e.Y+"-"+e.m+"-"+e.d+" "+e.H+":"+e.i+":"+e.s;d.loop(e,function(a,c){e[c]=10>a?"0"+a:a;b&&(b=b.replace(c,a))});return b?b:e};d.days=function(a,d){return(new Date(a,d,0)).getDate()};d.week=function(a,d,c){a=(new Date(a+"-"+d+"-"+c)).getDay();return 0==a?7:a};d.API=function(a,b,c,e,f,g){f=f?f:"json";a=d.urlAdd(a,{ajax:1});c=c?c:new Function;e=e?e:new Function;b={type:b?"POST":"GET",url:a,dataType:f,data:b,success:function(b){b&&"object"==typeof b?d.isset(b.result)?(b.result.KSAUI&&("Dialog"==b.result.KSAUI.type?(b.result.KSAUI.param.push(function(a){return c?c(a):!0}),d.Dialog.apply("",b.result.KSAUI.param)):d[b.result.KSAUI.type].apply("",b.result.KSAUI.param)),d.isset(b.msg)&&b.msg?b.confirm?d.Dialog("confirm","\u63d0\u793a\u4fe1\u606f",b.msg,function(){c(b.result,b);b.success&&b.locationUrl&&(window.location.href=b.locationUrl)},"\u786e\u8ba4"):(b.success?d.toast(b.msg,"success",function(){b.success&&b.locationUrl&&(window.location.href=b.locationUrl)}):d.toast(b.msg,"error"),c(b.result,b)):c(b.result,b)):(console.log("%cKSAUI-AJAX-ERROR API\u5f02\u5e38\u8fd4\u56de\uff01URL\uff1a"+a+"\n","background:#f00; color:#fff",b),e(b)):d.toast("error","ajax\u8fdc\u7aef\u7cfb\u7edf\u9519\u8bef")},error:function(c){console.log("%cKSAUI-AJAX-ERROR (Code:"+c.status+")","background:#f00; color:#fff","URL:"+a);d.toast("ajax\u8fdc\u7aef\u7cfb\u7edf\u9519\u8bef","error");"function"===typeof e&&e(c)}};g&&(b.processData=!1,b.contentType=!1);d.ajax(b);return!1};d.ajaxWin=function(a,b){return d.API(b,"",function(c){d.layer({title:a,content:c,cover:1})})};d.plugin.formSubmit=function(a){var b=this.eq(0);if(!b.length)return!1;var c=b.attr("confirm");""===c&&(c="\u786e\u8ba4\u8981\u63d0\u4ea4\u8be5\u4fe1\u606f\u5417\uff1f");var e,f=function(){var c=b.find("button[type\x3dsubmit], input[type\x3dsubmit], ks-btn[submit]"),f=c.html();c.addClass("btn-load").disabled(!0).text(f);var h=b.formData(!0);b.attr("id")&&h.append("FORMID",b.attr("id"));e=d.toast("\u8bf7\u7a0d\u540e","","","",0).id;d.API(d.urlAdd(b.attr("action"),"formsubmit\x3dtrue"),h,function(g,k){d.layerHide(e);c.removeClass("btn-load").disabled(!1).html(f);if(a&&!1===a.apply(b[0],arguments))return!1;d.isObject(g)&&k.success&&d("body").attr("parentlayerid")&&(d.layerHideF(),window.parent.$.layerHide(e))},function(){d.layerHide(e);c.removeClass("btn-load").disabled(!1).html(f)},"json",1);setTimeout(function(){c.removeClass("btn-load").disabled(!1).html(f);d.layerHide(e)},3E4)};c?d.Dialog("confirm","\u64cd\u4f5c\u63d0\u793a",c,f):f();return!1};d.upload=function(a,b,c,e){a=a?a:"upload";var f=new FormData;b instanceof Blob?f.append(a,b):(b=b.files,1<b.length&&-1===a.indexOf("[]")&&(a+="[]"),d.loop(b,function(c){c.size&&c.type&&f.append(a,c)}));this.API(c,f,function(a){e(a)},null,"json",1)};d.tag=function(a,b,c,e){var f="\x3c"+a;d.loop(b,function(a,c){a=void 0===a?null:a;a=!0===a?c:a;f+=c&&null!=a?" "+c+'\x3d"'+a+'"':""});f+="\x3e"+(c?c:"");e||(f+="\x3c/"+a+"\x3e");return f};d.plugin.listSelect=function(a){var b=this,c=d.isset(b.attr("multiple"));b.find("ks-list-item").click(function(e){if(!b.disabled()){var f=d(this);if(f.hasClass("ks-select-optgroup-title")||f.disabled())return!1;c?f.selected()?f.selected(!1):f.selected(!0):f.selected(!0).siblings().selected(!1);var g={};b.find("ks-list-item[selected]").each(function(a,c){c=d(c);g[c.attr("value")]=f.attr("_text")||f.attr("text")||f.text()});d.isFunction(a)&&a(f.attr("value"),f.attr("_text")||f.attr("text")||f.text(),g,f,e);return!1}});return this};d.selectToHtml=function(a,b){function c(a){return d.isArray(k)&&d.inArray(a,k)||d.isObjectPlain(k)&&d.isset(k[a])||a===k}function e(a){var b=0,f=[];a.children().each(function(a,g){g=d(g);var k=g.attr(),h={value:k.value||"",title:k.title||"",text:g.text()||"",showtitle:k.showtitle||"",selected:c(k.value)?!0:"",disabled:g.disabled()||"",icon:k.icon||"",style:k.style||"",n:m};"OPTGROUP"==g[0].tagName?(h.text=k.label||"",h.option=e(g)):m++;f[b]=h;b++});return f}function f(a){var e="";d.loop(a,function(a,g){a.option?e+='\x3cks-list-item class\x3d"ks-select-optgroup-title"\x3e\x3cstrong\x3e'+a.text+'\x3c/strong\x3e\x3cks-list class\x3d"ks-list-select" '+(b?' multiple\x3d"multiple"':"")+"\x3e"+f(a.option)+"\x3c/ks-list\x3e\x3c/ks-list-item\x3e":(d.isObject(a)||d.isArray(a)||(a={value:g,text:a,selected:c(g)}),e+=d.tag("ks-list-item",{selected:a.selected?"selected":"",disabled:a.disabled,icon:a.icon,style:a.style,title:a.title,value:a.value,n:a.n,_text:a.showtitle||a.text},a.text))});return e}var g,k,h,m=0;d.isObjectPlain(a)?(g=a,k=a.value,b=d.isset(b)?b:a.multiple):d.isArray(a)?g=a:(h=d(a),b=h.prop("multiple"),k=h.val(),g=e(h));return[h,b,'\x3cks-list class\x3d"ks-list-select" '+(b?' multiple\x3d"multiple"':"")+"\x3e"+f(g)+"\x3c/ks-list\x3e"]};d.plugin.showSelect=function(a,b,c,e){function f(){h&&d.layerHide(h);g.removeData("layer-id").active(!1)}var g=d(this[0]),k="INPUT"===this[0].tagName;if(!g.disabled()){var h=g.data("layer-id");if(h)f();else return c=a.multiple,k&&!a.option?a={value:[g.val()],option:a}:a.option||(a={option:a}),a.value=a.value&&!d.isArray(a.value)?[a.value]:a.value,e=e||{},e=d.arrayMerge({title:a.label?a.title||a.label:!1,pos:d.isMobile?"8":g,cover:d.isMobile?2:0,content:u(a,a.value,a.multiple),closeBtn:0,bodyOver:!1,init:function(a){if(a.layerID){h=a.layerID;g.data("layer-id",h).active(!0);var e=a.find(".ks-layer-content");e.find("ks-list-item[selected]").length&&e.scrollTop(e.find("ks-list-item[selected]").eq(0).offset().top-e.offset().top-e.find("ks-list-item").eq(0).height());d(e.find(".ks-list-select")).listSelect(function(a,d,h,m,l){l.stopPropagation();c&&(d="",e.find("ks-list-item[selected]").each(function(a,c){d+="\x3cspan\x3e"+c.innerHTML+"\x3c/span\x3e"}),d=d?d:"\u8bf7\u9009\u62e9");k&&g.val(d);b&&b.call(m,a,d,h,m,l);c||f()})}},show:function(a){h=a.layerID;if(!d.isMobile)d(document).on("click.KSAUI-select",function(c){d.inArray(c.target,[g[0],a[0]])||(d(document).off("click.KSAUI-select"),f())})},hide:f},e,{"class":"ks-layer-select"}),a=d.layer(e),h=a.id,a}};d.showDate=function(a,b,c){function e(a){a=a&&!m?k+" "+a:a;a=f.times(a);if(a.Y&&a.m){var c="",d=a.Y,b=parseInt(a.m)-1;1>b&&(b=12,d--);for(var e=f.days(d,b),g=f.week(d,b,e),c=c+"\x3cem\x3e\u4e00\x3c/em\x3e\x3cem\x3e\u4e8c\x3c/em\x3e\x3cem\x3e\u4e09\x3c/em\x3e\x3cem\x3e\u56db\x3c/em\x3e\x3cem\x3e\u4e94\x3c/em\x3e\x3cem\x3e\u516d\x3c/em\x3e\x3cem\x3e\u65e5\x3c/em\x3e",h=0,g=e-g+1;g<=e;g++)c+='\x3ci class\x3d"_" data-value\x3d"'+d+"-"+b+"-"+g+'"\x3e'+g+"\x3c/i\x3e",h++;for(g=1;g<=f.days(a.Y,a.m);g++)c+='\x3ci class\x3d"'+(g==a.d?" a":"")+'" data-value\x3d"'+a.Y+"-"+a.m+"-"+g+'"\x3e'+g+"\x3c/i\x3e",h++;h=42-h;if(0<h)for(d=a.Y,b=a.m,b++,12<b&&(b=1,d++),g=1;g<=h;g++)c+='\x3ci class\x3d"_" data-value\x3d"'+d+"-"+b+"-"+g+'"\x3e'+g+"\x3c/i\x3e";a.html=c;return a}}var f=this;a=d(a);var g=a[0]&&"INPUT"==a[0].tagName?a:null;if(a.data("layer-id"))d.layerHide(a.data("layer-id"));else{b=b?b:a.attr("format")||"Y-m-d H:i";var k=g?g.val():a.attr("value"),h=-1!=b.indexOf("Y"),m=-1!=b.indexOf("m")&&-1!=b.indexOf("d"),h=h&&m,l=-1!=b.indexOf("H")&&-1!=b.indexOf("i"),q=l&&-1!=b.indexOf("s"),p=e(k),n="";l&&(n='\x3cdiv class\x3d"ks-calendar-b ks-clear"\x3e\x3cdiv class\x3d"ks-calendar-time"\x3e'+('\x3cdiv\x3e\x3cinput type\x3d"ks-number" value\x3d"'+p.H+'" min\x3d"0" max\x3d"23"\x3e\x3c/div\x3e'),n=n+"\x3cdiv\x3e:\x3c/div\x3e"+('\x3cdiv\x3e\x3cinput type\x3d"ks-number" value\x3d"'+p.i+'" min\x3d"0" max\x3d"59"\x3e\x3c/div\x3e'),q&&(n=n+"\x3cdiv\x3e:\x3c/div\x3e"+('\x3cdiv\x3e\x3cinput type\x3d"ks-number" value\x3d"'+p.s+'" min\x3d"0" max\x3d"59"\x3e\x3c/div\x3e')),n+='\x3c/div\x3e\x3cks-btn color\x3d"primary"\x3e\u786e\u8ba4\x3c/ks-btn\x3e\x3c/div\x3e');var r='\x3cdiv class\x3d"ks-calendar" data-y\x3d"'+p.Y+'" data-m\x3d"'+p.m+'" data-d\x3d"'+p.d+'"\x3e';h&&(r+='\x3cdiv class\x3d"ks-calendar-t"\x3e\x3ci icon\x3d"arrow-left-s-fill"\x3e\x3c/i\x3e\x3ci icon\x3d"arrow-left-s"\x3e\x3c/i\x3e\x3cem\x3e'+p.Y+"\u5e74\x3c/em\x3e\x3cem\x3e"+p.m+'\u6708\x3c/em\x3e\x3ci icon\x3d"arrow-right-s"\x3e\x3c/i\x3e\x3ci icon\x3d"arrow-right-s-fill"\x3e\x3c/i\x3e\x3c/div\x3e\x3cdiv class\x3d"ks-calendar-ul"\x3e'+p.html+"\x3c/div\x3e");d.layer({cover:!!d.isMobile,pos:d.isMobile?8:a,width:d.isMobile?"100%":null,content:r+n+"\x3c/div\x3e",closeBtn:0,bodyOver:!1,show:function(h){function m(){var d=k;-1!=b.indexOf("m")&&(d=n.find(".ks-calendar-ul i.a").data("value"));if(l){var e=n.find(".ks-calendar-time input");e.length&&(d+=" "+e.eq(0).val()+":"+e.eq(1).val(),q&&(d+=":"+e.eq(2).val()))}d=f.times(d);d=b.replace("Y",d.Y).replace("m",d.m).replace("d",d.d).replace("H",d.H).replace("i",d.i).replace("s",d.s);g&&(g.val(d),g.trigger("input").trigger("change"));a.attr("value",d);c&&c(d);return d}function p(){n.find(".ks-calendar-ul i").click(function(){d(this).addClass("a").siblings().removeClass("a");!l&&m();n.find(".ks-calendar-b").length||d.layerHide(h.layerID);return!1})}a.data("layer-id",h.layerID);var n=h.find(".ks-calendar");h.click(function(a){a.stopPropagation();return!1});d.isMobile&&(h.find(".ks-layer-content").css("padding","0"),h.find(".ks-calendar").css("width","100%"));p();n.find(".ks-calendar-t i").click(function(){var a=d(this).index(),c=parseInt(n.data("y")),b=parseInt(n.data("m")),f=parseInt(n.data("d"));0==a?c--:5==a?c++:1==a?(b--,1>b&&(b=12,c--)):4==a&&(b++,12<b&&(b=1,c++));n.data({y:c,m:b});a=d(this).siblings("em");a.eq(0).text(c+"\u5e74");a.eq(1).text(b+"\u6708");n.find(".ks-calendar-ul").html(e(c+"-"+b+"-"+f).html);p();return!1});n.find("ks-btn").click(function(){m();d.layerHide(h.layerID);return!1});h.hover(function(){a.attr("ks-date-show",1)},function(){a.removeAttr("ks-date-show")});g&&g.blur(function(){!d(this).attr("ks-date-show")&&d.layerHide(h.layerID)});d(document).on("click.KSAUI-showdate",function(c){d.inArray(c.target,[a[0],h[0]])||(d(document).off("click.KSAUI-showdate"),d.layerHide(h.layerID))})},close:function(){a.removeData("layer-id")}})}};d.plugin.showMenu=function(a,b){var c=this,e="";d.isString(b)?e=b:(e="",d.loop(b,function(a,c){e=d.isString(a)?e+a:e+d.tag(a.url?"a":"p",{style:a.style,href:a.url,icon:a.icon,"dropdown-event-key":c},a.label)}),e=d(e),e.filter("[dropdown-event-key]").map(function(a){a=d(a);var c=a.attr("dropdown-event-key");(c=b[c])&&c.event&&a.click(c.event)}));this.on("hover"===a?"mouseenter":a,function(){c.active()||(c.active(!0),d.layer({pos:c,cover:0,content:e,closeBtn:0,bodyOver:!1,init:function(b){b.addClass("ks-layer-showmenu");if("hover"===a){var e;c.push(b).hover(function(){e&&window.clearTimeout(e)},function(){e=window.setTimeout(function(){d.layerHide(b.layerID)},100)})}},show:function(c){if("hover"!==a)d(document).on("click.KSAUI-dropdown",function(a){a.target!==c[0]&&(d.layerHide(c.layerID),d(document).off("click.KSAUI-dropdown"))})},close:function(){c.active(!1)}}))})};d.plugin.area=function(a,b,c,e,f){function g(a,b){var e={current:{},data:{},isEnd:b?1:0};r.find(".ks-area-layer-btn p").each(function(c,b){b=d(b);var f=b.attr("field");if(b.attr("val")){var g={id:b.attr("val"),name:b.text(),level:c,field:f};a&&a==b.attr("val")&&(e.current=g);e.data[f]=g}});d.isFunction(c)&&c(e)}function k(a,c){a=a?a:"";d.API(l,{id:a,level:n},function(b){var f="";d.loop(b,function(b){f+=d.tag("ks-list-item",{upid:a,val:b.id,selected:c&&c==b.id?"selected":null},b.name)});f?(f='\x3cks-list class\x3d"ks-list-select"\x3e'+f+"\x3c/ks-list\x3e",r.find(".ks-area-layer-c").html(f),function(){var a=r.height(!0),c=r.find(".ks-area-layer-c");c.height(a-r.find(".ks-area-layer-btn").height(!0));a=c.find("ks-list-item[selected]");a.length?c.scrollTop(a.index()*a.height(!0)):c.scrollTop(0)}(),r.find(".ks-list-select").listSelect(function(a,c,b,f,l){a=f.attr("val");f.selected(!0).siblings().removeAttr("selected");b=r.find(".ks-area-layer-btn").find("p").eq(n);b.text(c).attr({upid:f.attr("upid"),val:a,field:p[n]}).show();b.next().attr("upid",a).html('\x3cspan class\x3d"ks-text-gray"\x3e'+q[n+1]+"\x3c/span\x3e").show();n==e-1?(d.layerHide(m),h.removeData("layer-id").active(!0),g(a,1)):n<e&&(k(a),n++,g(a))})):(d.layerHide(m),h.removeData("layer-id").active(!1))})}var h=d(this[0]),m=0;if(h.data("layer-id"))m=h.data("layer-id"),d.layerHide(void 0),h.removeData("layer-id").active(!1);else{var l=f?f:"common/area";e=0<=e&&4>e?e:4;var q=["\u9009\u62e9\u7701\u4efd/\u5730\u533a","\u9009\u62e9\u57ce\u5e02","\u9009\u62e9\u533a/\u53bf","\u9009\u62e9\u57ce\u9547","\u9009\u62e9\u8857\u9053"],p=["province","city","area","town"],n=0,r;d.layer({pos:d.isMobile?8:h,cover:d.isMobile?2:0,width:d.isMobile?"100%":"",height:d.isMobile?"75%":"","class":"ks-area-layer",content:'\x3cdiv class\x3d"ks-area-layer-btn"\x3e\x3cp\x3e\x3cspan class\x3d"ks-text-gray"\x3e'+q[0]+'\x3c/span\x3e\x3c/p\x3e\x3cp\x3e\x3c/p\x3e\x3cp\x3e\x3c/p\x3e\x3cp\x3e\x3c/p\x3e\x3c/div\x3e\x3cdiv class\x3d"ks-area-layer-c"\x3e\u8bf7\u7a0d\u540e...\x3c/div\x3e',closeBtn:!1,bodyOver:!1,init:function(a,c){r=a;m=c;h.data("layer-id",c).active(!0);a.click(function(){return!1});if(b){var e=a.find(".ks-area-layer-btn p"),f={},l=0;d.loop(b,function(a,c){l=0<c?b[c-1].id:0;e.eq(a.level).text(a.name).attr({upid:l,val:a.id,field:a.field}).show();n<a.level&&(n=a.level,f=a)});k(l,f.id)}else k();a.find(".ks-area-layer-btn p").click(function(){var a=d(this);n=a.index();a.nextAll().text("").removeClass("a").attr("upid","").attr("val","").hide();k(a.attr("upid"),a.attr("val"));g(a.attr("val"))})},show:function(a){d(document).on("click.KSAUI-area",function(c){d.inArray(c.target,[h[0],a[0],a.next('[data-layer-key\x3d"'+a.layerID+'"]')[0]])||(d(document).off("click.KSAUI-area"),d.layerHide(a.layerID),h.removeData("layer-id").active(!1))})}})}};d.showTip=function(a,b,c){a=d(a);if(b=b?b:a.attr("title")||""){d.ZINDEX++;d("body").append('\x3cdiv class\x3d"ks-ftip" style\x3d"z-index:'+this.ZINDEX+'"\x3e'+b+'\x3cspan class\x3d"ks-ftip-x"\x3e\x3c/span\x3e\x3c/div\x3e');var e=d(".ks-ftip");e.show();b=e.height(!0)+e.find(".ks-ftip-x").height(!0)/2;c=Math.min(a.offset().left-10,window.innerWidth-e.width(!0)-10);e.find(".ks-ftip-x").css({left:a.offset().left-c+5});e.css({left:c,top:a.offset().top-b});var f;a.hover(function(){f&&clearTimeout(f)},function(){f=setTimeout(function(){e.remove()},10)});e.hover(function(){f&&clearTimeout(f)},function(){f=setTimeout(function(){e.remove()},10)})}};d.plugin.slide=function(a){function b(c){c=d(c);c.children(".ks-slide-c").height(c.height(!0));var b={id:d.objectID(c[0]),width:c.width(!0),height:c.height(!0),item:c.find(".ks-slide-item"),itemC:"",MX:0,num:0,playIndex:0,init:function(){var e=this;e.num=this.item.length-1;var g=0;e.item.each(function(a,c){c=d(c);var b=c.width(!0,!0),e=c.width(!0);c.data("width",e).width(e);g+=b});var k=d('\x3cdiv class\x3d"ks-slide-c" style\x3d"width:'+(g+10)+'px; height:100%"\x3e\x3c/div\x3e');k.html(this.item);c.html(k);e.itemC=k;var h="";a.control&&(h+='\x3cdiv class\x3d"ks-slide-control-prev" icon\x3d"arrow-left-s"\x3e\x3c/div\x3e\x3cdiv class\x3d"ks-slide-control-next" icon\x3d"arrow-right-s"\x3e\x3c/div\x3e');a.status&&(h+='\x3cdiv class\x3d"ks-slide-status"\x3e',d.loop(e.num+1,function(){h+="\x3cspan\x3e\x3c/span\x3e"}),h+="\x3c/div\x3e");a.progress&&(h+='\x3cdiv class\x3d"ks-slide-progress"\x3e\x3cspan '+(1!=a.progress?' class\x3d"ks-bg-'+a.progress.trim()+'"':"")+"\x3e\x3c/span\x3e\x3c/div\x3e");h&&c.append(h);a.control&&(c.find(".ks-slide-control-prev").click(function(){b.play("prev")}),c.find(".ks-slide-control-next").click(function(){b.play("next")}));a.status&&c.find(".ks-slide-status span").click(function(){var a=d(this).index();if(a!=e.playIndex){var c="next";a<e.playIndex&&(c="prev");e.play(c,a);d(this).addClass("a").siblings().removeClass("a")}});e.playIndex=e.num;e.play("next",0);var m=e.itemC;c.touch(function(){m.addClass("_a")},function(a,c){"left"!==c.action&&"right"!==c.action||m.css({transform:"translateX("+(c.moveX+e.MX)+"px) scale(1)"})},function(a,c){m.removeClass("_a");"right"===c.action&&0>=e.playIndex||"left"===c.action&&e.playIndex>=e.num?e.move(e.playIndex):"left"==c.action?b.play("next"):"right"==c.action&&b.play("prev")},"X")},move:function(a){var c=0-this.item.eq(a).data("width")*a;this.itemC.css({transform:"translateX("+c+"px) scale(1)"}).attr("index",a);this.MX=c},play:function(b,e){var f=this;d.isset(e)?e=parseInt(e):(e=f.playIndex,"prev"==b?e--:"next"==b&&e++);e=0>e?0:e>f.num?0:e;c.attr({playerindex:e,playeraction:b});f.move(e);f.playIndex=e;a.auto&&d.setTimeout("ksauiSlide"+f.id,function(){f.play(b)},a.auto);a.status&&c.find(".ks-slide-status span").removeClass("a").eq(e).addClass("a")}};b.init()}a={auto:d.isset(a.auto)?d.floatval(""===a.auto?5:a.auto):5,card:d.isset(a.card),control:d.isset(a.control),status:d.isset(a.status)};a.auto=a.auto?1E3*d.floatval(a.auto):0;this.map(function(a){a._KSAUI_slideRender||(a._KSAUI_slideRender=!0,b(a))});return this};d.plugin.announcement=function(a,b,c){a=0<a?a:10;b=b?b:"ul";c=c?c:"li";this.each(function(){function e(){m=window.setInterval(function(){h++;h==k&&(h=0);f.find(b).css("margin-top",0-h*g)},1E3*a)}var f=d(this);f.addClass("ks-transition");var g=f.height(!0),k=f.find(c).length,h=0,m;e();f.hover(function(){window.clearInterval(m)},function(){e()})});return this};d.createForm=function(a){a=d.isArray(a)?{action:"",field:a}:a;var b=d.tag("form",{action:a.action,"class":a["class"]},"",!0),b=b+"\x3cks-form\x3e";d.loop(a.field,function(a,e){if(a&&d.isObject(a))if(a.value=a.value?a.value:"",a.name=a.name?a.name:e,a.placeholder=a.placeholder?a.placeholder:"\u8bf7\u8f93\u5165...",a.style=a.style?' style\x3d"'+a.style+'"':"","hidden"===a.type)b+=d.tag("input",{type:"hidden",name:a.name,value:a.value},"",!0);else{b+=d.tag("ks-form-item",{label:a.label,required:a.required,extra:a.extra},"",!0);if(a.after||a.before)b+="\x3cks-input-group\x3e",b+=a.before?a.before:"";if(d.inArray(a.type,["number","text","password","tel","color"]))a.type=a.unit?a.type:"ks-"+a.type,delete a.label,a.unit&&(b+="\x3cks-input-group\x3e"),b+=d.tag("input",a,"",1),a.unit&&(b+="\x3ci\x3e"+a.unit+"\x3c/i\x3e",b+="\x3c/ks-input-group\x3e");else if(d.inArray(a.type,["textarea"])){a.type="ks-"+a.type;var c=a.value;delete a.value;b+=d.tag("textarea",a,c)}else if("switch"==a.type)a.value=a.value?a.value:"",b+=d.tag("input",{type:"ks-switch",name:a.name,value:a.value,text:a.text?a.text:"\u662f",style:a.style,checked:1==a.value?" checked":null},"",1);else if("radio"==a.type)d.loop(a.option,function(c,e){b+=d.tag("input",{type:"ks-radio",name:a.name,value:e,text:c,checked:a.value==e?" checked":null,style:a.style},"",1)});else if("checkbox"==a.type)(function(){function c(b){var e="";d.loop(b,function(b,f){d.isObject(b)?(e+='\x3cdiv class\x3d"ks-mb2"\x3e\x3cp class\x3d"ks-fw3 ks-mb1"\x3e'+f+"\x3c/p\x3e",e+="\x3cp\x3e",e+=c(b),e+="\x3c/p\x3e\x3c/div\x3e"):e+=" "+d.tag("input",{type:"ks-checkbox",name:a.name+"[]",value:f,text:b,checked:a.value==f||d.inArray(f,a.value)?" checked":null,style:a.style},"",1)});return e}b+=c(a.option)})();else if("select"==a.type){var g="";d.loop(a.option,function(a,b){d.isObject(a)&&(b=a.id,a=a.value);g+=d.tag("option",{value:b},a)});a.type="ks-"+a.type;delete a.option;b+=d.tag("select",a,g)}else"date"==a.type?b+=d.tag("input",{type:"ks-date",name:a.name,value:a.value,title:a.title,placeholder:a.placeholder,style:a.style,format:a.format},"",1):"area"==a.type?(b+=d.tag("ks-area",{province:a.value.province,city:a.value.city,area:a.value.area,town:a.value.town,maxlevel:a.value.maxlevel?maxlevel:4},"\u8bf7\u9009\u62e9"),d.isset(a.value.address)&&(b+='\x3cinput type\x3d"text" name\x3d"address"  value\x3d"'+a.value.address+'" placeholder\x3d"\u8bf7\u8f93\u5165\u8857\u9053\u5730\u5740" class\x3d"ks-input ks-mt1"\x3e')):d.inArray(a.type,["pic","file"])?(a.type="ks-"+a.type,b+=d.tag("input",a,"",1)):b+=a.value;if(a.after||a.before)b+=a.after?a.after:"",b+="\x3c/ks-input-group\x3e";b+="\x3c/ks-form-item\x3e"}else a&&d.isString(a)&&(b+="\x3cks-form-title\x3e"+a+"\x3c/ks-form-title\x3e")});return b+="\x3c/ks-form\x3e\x3c/form\x3e"};d.imgZoom=function(a,b,c,d){a=a.files[0];var e=new FileReader;e.readAsDataURL(a);var g=new Image;e.onload=function(a){g.src=a.target.result};g.onload=function(e){e=document.createElement("canvas");var f=e.getContext("2d"),k=this.width,l=this.height,q=k,p=l;if(k>b||l>c)1<k/l?(q=b,p=Math.round(l/k*b)):(p=c,q=Math.round(k/l*c));e.width=q;e.height=p;f.clearRect(0,0,q,p);f.drawImage(g,0,0,q,p);e.toBlob(function(b){b=new File([b],a.name,a);d&&d(b)},a.type,1)}};d.Drop=function(a){a=d(a);var b=a.data("debug")?!0:!1,c={Ele_start:null,Ele_In:null,Ele_Parent:null,dragstart:function(c,f,g){this.Ele_start||(this.Ele_start=f,this.Ele_Parent=g,f=d(f),b&&console.log("\u62d6\u62fd\u5f00\u59cb",f.text()),f.addClass("_drag"),c._KSA_Drop_Arg_={start:this.Ele_start,end:null},a.trigger("dragStart"))},drag:function(a,b,c){},dragend:function(c,f,g){b&&console.log("\u62d6\u62fd\u7ed3\u675f",c,this);this.Ele_start&&d(this.Ele_start).removeClass("_drag");this.Ele_In&&d(this.Ele_In).removeClass("_drag_in").css("margin-left",0);this.Ele_start&&this.Ele_In&&this.Ele_start!=this.Ele_In&&(b&&console.log("\u62d6\u62fd\u4e86",this.Ele_start,"\u653e\u5230",this.Ele_In),c._KSA_Drop_Arg_={start:this.Ele_start,end:this.Ele_In},a.trigger("dragEnd"));this.Ele_Parent=this.Ele_In=this.Ele_start=null},drop:function(a,c,d){b&&console.log("handleDrop",a.target)},dragenter:function(c,f,g){this.Ele_start&&this.Ele_In!=f&&(f=d(f),g!=this.Ele_Parent?b&&console.log("\u4e0d\u662f\u540c\u4e00\u4e2a\u7236\u7ea7"):this.Ele_start!=f[0]&&f.prev()[0]!=this.Ele_start&&(this.Ele_In&&this.Ele_In!=f[0]&&(d(this.Ele_In).removeClass("_drag_in").css("margin-left",0),b&&console.log("\u62d6\u62fd\u91ca\u653e",this.Ele_In.innerText),c._KSA_Drop_Arg_={start:this.Ele_start,end:this.Ele_In},a.trigger("dragLeave")),b&&console.log("\u62d6\u62fd\u786e\u8ba4",f.text())))},dragover:function(c,f,g){this.Ele_start&&this.Ele_In!=f&&(f=d(f),g!=this.Ele_Parent?b&&console.log("\u4e0d\u662f\u540c\u4e00\u4e2a\u7236\u7ea7"):this.Ele_start!=f[0]&&f.prev()[0]!=this.Ele_start&&(this.Ele_In&&this.Ele_In!=f[0]&&(d(this.Ele_In).removeClass("_drag_in").css("margin-left",0),b&&console.log("\u62d6\u62fd\u91ca\u653e",this.Ele_In.innerText)),b&&console.log("\u62d6\u62fd\u7ecf\u8fc7",f.text()),this.Ele_In=f[0],f.addClass("_drag_in").css("margin-left",d(this.Ele_start).width(!0)),c._KSA_Drop_Arg_={start:this.Ele_start,end:this.Ele_In},a.trigger("dragEnter")))},dragleave:function(a,b,c){}};a.find("\x3e *").attr("draggable","true").on("dragstart drag dragend drop dragenter dragover dragleave",function(b){c[b.type]&&c[b.type](b,this,a[0])})};(function(){d.render('select.ks-select, select[type\x3d"ks-select"], select[ks-render-type\x3d"select"]',function(a,b,c){var e=d(a);a=e.attr();if("SELECT"==e[0].tagName)if(b||(e.removeClass("ks-select").attr({type:"","ks-render-type":"select"}),!d.isset(a.value)&&a["data-value"]&&(a.value=a["data-value"]),d.isset(a.value)&&e.val(a.value)),d.isset(a.open))if(b)e.next().disabled(e.disabled());else{b=v(e[0]);var f=d('\x3cdiv class\x3d"ks-select-list"\x3e'+u(b,b.value,b.multiple)+"\x3c/div\x3e");f.children().listSelect(function(a,b,c){d(e).val(Object.keys(c)).trigger("change")});e.after(f).hide();f.prepend(e);e.next().disabled(e.disabled());e.DOMchange("val",function(){var a=d(this).val();f.find("ks-list-item").selected(!1);a=d.isArray(a)?a:[a];d.loop(a,function(a){f.find('ks-list-item[value\x3d"'+a+'"]').selected(!0)})})}else{var g=function(){var a="";e.find("option:selected").each(function(b,c){a+=c.text?"\x3cspan\x3e"+c.text+"\x3c/span\x3e":""});return a?a:e.attr("deftext")||"\u8bf7\u9009\u62e9"};b?e.parent().children(".ks-select-title").html(g()):(e.wrap(d.tag("div",{"class":"ks-select",style:a.style})),e.after('\x3cspan class\x3d"ks-select-title"\x3e'+g()+"\x3c/span\x3e"),e.next().click(function(){if(!e.disabled()){var a=v(e[0]);d(this).showSelect(a,function(a,b,c){e.val(Object.keys(c)).attr("value",a)})}}),e.DOMchange("val",function(){e.next(".ks-select-title").html(g());e.trigger("change")}))}},"attr.value attr.data-value attr.disabled");d.render('input[type\x3d"ks-radio"]',function(a){a=d(a);var b=a.attr(),c=b.text?"\x3cem\x3e"+b.text+"\x3c/em\x3e":"";a.attr({type:"radio"});a.wrap(d.tag("label",{type:"radio","class":"ks-radio",icon:b.icon,style:b.style,color:b.color}));a.after("\x3ci\x3e"+c+"\x3c/i\x3e");a.change(function(){d(this).trigger("KSADOMchange",["attr.checked",this.checked])})});d.render('input[type\x3d"ks-checkbox"]',function(a){var b=d(a);a=b.attr();var c=a.text?"\x3cem\x3e"+a.text+"\x3c/em\x3e":"";b.attr({type:"checkbox"});b.wrap(d.tag("label",{type:"checkbox","class":"ks-checkbox",icon:a.icon,style:a.style,color:a.color}));b.after("\x3ci\x3e"+c+"\x3c/i\x3e");var e=b.parent().parent();if(e.length&&e.attr("max")){var f=parseInt(e.attr("max"))||0;0<f&&b.change(function(){var a='input[type\x3d"checkbox"][name\x3d"'+b.attr("name")+'"]';e.find(a+":checked").length==f&&b.checked()?e.find(a+":not(:checked)").disabled(!0):e.find(a+":not(:checked)").disabled(!1)})}b.DOMchange("attr.checked",function(){d(this).trigger("change")})});d.render('input[type\x3d"ks-checkbox-all"]',function(a){var b=d(a);a=b.attr();var c=a.text?"\x3cem\x3e"+a.text+"\x3c/em\x3e":"";b.attr({type:"checkbox",ischeckall:1});b.wrap(d.tag("label",{type:"checkbox","class":"ks-checkbox",icon:a.icon,style:a.style,color:a.color}));b.after("\x3ci\x3e"+c+"\x3c/i\x3e");a=b.attr("name");if(!a)return this;var e=d(b.attr("selector")||b.parent()[0].form||b.parent().parent()),f=b.parent(),g='input[type\x3d"checkbox"][name\x3d"'+a+'"]:not([ischeckall])';b.change(function(){e.find(g).checked(this.checked)}).DOMchange("attr.checked",function(){e.find(g).checked(this.checked)});b.on("changeALL",function(){var a=!1,c=e.find(g+":checked").length;c>=e.find(g).length?(a=!0,f.removeClass("ks-checkbox-indeter")):0<c?(a=!1,f.addClass("ks-checkbox-indeter")):c||(a=!1,f.removeClass("ks-checkbox-indeter"));b[0].checked=a});e.on("change",g,function(){b.trigger("changeALL")})});d.render('input[type\x3d"ks-switch"]',function(a){a=d(a);var b=a.attr(),c=a.checked()?1:0,e=b.text||"",f=b.name?' name\x3d"'+b.name+'"':"";e&&(e=e.split("|"),e=d.isset(e[1])?"\x3cem\x3e"+e[1]+"\x3c/em\x3e\x3cem\x3e"+e[0]+"\x3c/em\x3e":"\x3cem\x3e"+e[0]+"\x3c/em\x3e");a.attr("type","checkbox").removeAttr("name");a.wrap(d.tag("label",{type:"switch","class":"ks-switch",icon:b.icon,style:b.style,color:b.color}));a.after("\x3ci\x3e"+e+'\x3c/i\x3e\x3cinput type\x3d"hidden" '+f+' value\x3d"'+c+'"\x3e');a.change(function(){var a=this.checked;d(this).trigger("KSADOMchange",["attr.checked",a]).nextAll("input[type\x3dhidden]").val(a?1:0)})});d.render('input[type\x3d"ks-number"]',function(a){function b(b){var c=a.val(),e=1<c.length&&"0"===c.substr(0,1),c=d.floatval(c)||0;"up"==b?k?c+=k:c++:k?c-=k:c--;c=0<h?c.toFixed(h):c;c=c<f?f:c;c=g&&c>g?g:c;a.val(9>=c&&e?"0"+c:c)}a=d(a);var c=a.attr();a.attr("type","number").addClass("ks-input");a.wrap(d.tag("span",{type:"number","class":"ks-input ks-input-arrow",icon:c.icon,style:c.style}));a.after('\x3cspan data-digit\x3d"down" icon\x3d"subtract"\x3e\x3c/span\x3e\x3cspan data-digit\x3d"up" icon\x3d"add"\x3e\x3c/span\x3e');var e=a.attr();a.val().length||e.placeholder||a.val(e.min||0);c=a.parent();!c.hasClass("ks-input-arrow")&&c.addClass("ks-input-arrow");var f=d.floatval(e.min)||0,g=d.floatval(e.max)||0,k=d.floatval(e.step)||0,h=k&&-1!=k.toString().indexOf(".")?k.toString().split(".")[1].length:0,m,l,e=d.isMobile?"touchstart touchend":"mousedown mouseup";c.find("*[data-digit]").on(e,function(c){var e=d(this).data("digit");d.inArray(c.type,["mousedown","touchstart"])?(b(e),m=setTimeout(function(){l=setInterval(function(){b(e)},60)},250)):(a.change(),clearInterval(l),clearTimeout(m))})});d.render('input[type\x3d"ks-date"]',function(a){var b=d(a);a=b.attr();b.attr("type","text");b.wrap(d.tag("span",{type:"date","class":"ks-input",icon:a.icon,style:a.style}));a.icon||a.iconleft||a.iconright||(a.iconright="calendar");(a.icon||a.iconleft)&&b.before('\x3cleft icon\x3d"'+(a.icon||a.iconleft)+'"\x3e\x3c/left\x3e');a.iconright&&b.before('\x3cright icon\x3d"'+a.iconright+'"\x3e\x3c/right\x3e');d.isMobile&&b.after('\x3ci class\x3d"ks-input-cover"\x3e\x3c/i\x3e');b.parent().click(function(){d.showDate(b)})});d.render('input[type\x3d"ks-color"]',function(a){a=d(a);var b=a.attr();a.attr("type",b.type.substr(3));b.label?x(a):a.wrap(d.tag("label",{type:"color","class":"ks-input-color",icon:b.icon,style:b.style}))});d.render('input[type\x3d"ks-text"], input[type\x3d"ks-tel"]',function(a){var b=d(a),c=b.attr();b.attr("type",c.type.substr(3));c.label||c.unit?x(b):b.wrap(d.tag("label",{type:"text","class":"ks-input",icon:c.icon,style:c.style}));(c.icon||c.iconleft)&&b.before('\x3cleft icon\x3d"'+(c.icon||c.iconleft)+'"\x3e\x3c/left\x3e');c.iconright&&b.before('\x3cright icon\x3d"'+c.iconright+'"\x3e\x3c/right\x3e');if(d.isset(c.clear)){var e=d('\x3cright class\x3d"ks-input-clear" icon\x3d"close-circle-fill" style\x3d"z-index:99"\x3e\x3c/right\x3e');b.before(e);e.click(function(){b.val("").focus();e.active(!1)});b.keyup(function(){0<b.val().length?e.active(!0):e.active(!1)});b.parent().hover(function(){0<d(this).find("input[type\x3dtext]").val().length&&e.active(!0)},function(){window.setTimeout(function(){e.active(!1)},10)})}if(c.api){var f,g;b.blur(function(){g&&d.layerHide(g);f&&window.clearTimeout(f)}).on("input focus",function(){var a=d(this).val();g&&d.layerHide(g);f&&window.clearTimeout(f);0<a.length&&(f=window.setTimeout(function(){d.layer({pos:b,cover:0,content:"\u8bf7\u7a0d\u540e...",closeBtn:0,bodyOver:!1,init:function(e){g=e.layerID;d.API(c.api,{keyword:a},function(a){var c='\x3cdiv class\x3d"ks-input-smart"\x3e';d.loop(a.list,function(a){c+='\x3cp value\x3d"'+a.value+'"\x3e'+a.title+"\x3c/p\x3e"});c+="\x3c/div\x3e";c=d(c);c.find("p").click(function(){b.val(d(this).text());d.layerHide(g)});e.find(".ks-layer-content").html(c)})}})},300))})}});d.render('input[type\x3d"ks-password"]',function(a){a=d(a);var b=a.attr();a.attr("type","password");a.wrap(d.tag("span",{type:"password","class":"ks-input ks-password",style:b.style})).removeAttr("icon");(b.icon||b.iconleft)&&a.before('\x3cleft icon\x3d"'+(b.icon||b.iconleft)+'"\x3e\x3c/left\x3e');b.iconright&&a.before('\x3cright icon\x3d"'+b.iconright+'"\x3e\x3c/right\x3e');a.active()&&(a.before('\x3cright icon\x3d"eye-off" active\x3e\x3c/right\x3e'),a.prevAll("right[active]").click(function(){var a=d(this),b=a.nextAll("input");"text"==b.attr("type")?(b.attr("type","password"),a.addClass("ri-eye-off").removeClass("ri-eye-fill")):(b.attr("type","text"),a.addClass("ri-eye-fill").removeClass("ri-eye-off"))}))});d.render('textarea[type\x3d"ks-textarea"]',function(a){var b=d(a);a=b.attr();b.removeAttr("type");b.wrap(d.tag("ks-textarea",{"class":"ks-textarea"}));var c=parseInt(b.attr("maxlength"));c&&(b.after('\x3cdiv class\x3d"ks-textarea-maxtit"\x3e \x3cspan\x3e'+b.val().length+"\x3c/span\x3e/"+c+"\x3c/div\x3e"),b.keyup(function(){b.val().length>c&&b.val(b.val().substr(0,c));b.next(".ks-textarea-maxtit").children("span").text(b.val().length)}));d.isset(a.auto)&&(b.height(b[0].scrollHeight),b.input(function(){b.height(0);b.height(b[0].scrollHeight)}))});d.render('input[type\x3d"ks-area"]',function(a){var b=["province","city","area","town"];a=d(a);a.attr({type:"hidden",name:""}).wrap("\x3cks-area "+(a.disabled()?"disabled":"")+"\x3e\x3c/ks-area\x3e");var c=a.attr(),e=0,f="",g=c.name;d.loop(b,function(a,b){var h=c[a],k=g?g+"["+a+"]":a;h&&(h=h.split(":"),f+='\x3cspan level\x3d"'+b+'"\x3e\x3cinput type\x3d"hidden" name\x3d"'+k+'[id]" value\x3d"'+h[0]+'"\x3e\x3cinput type\x3d"hidden" name\x3d"'+k+'[name]" value\x3d"'+h[1]+'"\x3e'+h[1]+"\x3c/span\x3e");d.isset(h)&&e++});a.after(f);a.parent().click(function(){var a=d(this),c=a.children('input[type\x3d"hidden"]'),f=c.attr();if(!f.disabled&&!a.disabled()){var l={};d.loop(b,function(a,c){var b=f[a];b&&(b=b.split(":"),l[c]={id:b[0],name:b[1],level:c,field:a})});a.area(f.title,l,function(b){if(b.isEnd){a.removeAttr("province city area town");var e={};d.loop(b.data,function(c){var b=g?g+"["+c.field+"]":c.field;e[c.field]=c.id+":"+c.name;a.children('span[level\x3d"'+c.level+'"]').html(c.name+'\x3cinput type\x3d"hidden" name\x3d"'+b+'[id]" value\x3d"'+c.id+'"\x3e\x3cinput type\x3d"hidden" name\x3d"'+b+'[name]" value\x3d"'+c.name+'"\x3e')});c.attr(e)}},e,f.api)}});a.DOMchange("attr.disabled",function(){a.parent().disabled(d(this).disabled())})});d.render('input[type\x3d"ks-pic"]',function(a){function b(b){var h="";e?(d.loop(b,function(a){h+='\x3cks-pic\x3e\x3cks-pic-thumb\x3e\x3cimg src\x3d"'+a.src+'"\x3e\x3cinput type\x3d"hidden" name\x3d"'+c.name+'" value\x3d"tmp:'+a.aid+'"\x3e\x3cspan icon\x3d"delete-bin-2-fill" delapi\x3d"'+c.api+"Del?aid\x3d"+a.aid+'"\x3e\x3c/span\x3e\x3c/ks-pic-thumb\x3e\x3c/ks-pic\x3e'}),g.before(h),0<f&&g.prevAll("ks-pic").length==f&&g.hide()):(d.loop(b,function(a){h+='\x3cks-pic-thumb\x3e\x3cimg src\x3d"'+a.src+'"\x3e\x3cinput type\x3d"hidden" name\x3d"'+c.name+'" value\x3d"'+a.aid+'"\x3e\x3c/ks-pic-thumb\x3e'}),b=a.parent(),b.prev().remove(),b.before(h));a.val("")}a=d(a);var c=a.attr();a.attr({type:"file",name:"",accept:"image/*",value:""});var e=/^.+\[\]$/g.test(c.name),f=e?parseInt(c.maxlength||0):0;a.wrap("\x3cks-pic\x3e\x3c/ks-pic\x3e").wrap('\x3clabel icon\x3d"add"\x3e\x3c/label\x3e');var g=a.parent().parent();if(c.value)try{if(e){c.value=JSON.parse(c.value.replace(/'/g,'"'));var k=0;d.loop(c.value,function(b){b.id&&(a.parent().parent().before('\x3cks-pic\x3e\x3cks-pic-thumb\x3e\x3cimg src\x3d"'+b.src+'"\x3e\x3cspan icon\x3d"delete-bin-2-fill"\x3e\x3c/span\x3e\x3cinput type\x3d"hidden" name\x3d"'+c.name+'" value\x3d"'+b.id+'"\x3e\x3c/ks-pic-thumb\x3e\x3c/ks-pic\x3e'),k++);0<f&&k>=f&&g.hide()})}else a.parent().before('\x3cks-pic-thumb\x3e\x3cimg src\x3d"'+c.value+'"\x3e\x3c/ks-pic-thumb\x3e')}catch(h){}a.change(function(){if(!c.api)return d.toast("\u7ec4\u4ef6\u7f3a\u5c11api\u5c5e\u6027"),!1;c.zoomhidth||c.zoomheight||c.zoom?d.imgZoom(this,c.zoomwidth||1920,c.zoomweight||1080,function(a){d.upload("upload",a,c.api,function(a){b(a.List)})}):d.upload("upload",a[0],c.api,function(a){b(a.List)})})});d.render('input[type\x3d"ks-file"]',function(a){a=d(a);a.attr();a.attr("type","file").css("display","none");a.wrap("\x3cks-btn upload\x3e\x3c/ks-btn\x3e").wrap('\x3clabel icon\x3d"upload-cloud-fill" style\x3d"display:block"\x3e\x3c/label\x3e')});d.render('input[type\x3d"ks-files"]',function(a){a=d(a);var b=a.attr().name,b=b?b+"[]":"";a.attr("type","file").css("display","none").attr("name",b+"[]");a.wrap("\x3cks-btn upload\x3e\x3c/ks-btn\x3e").wrap('\x3clabel icon\x3d"upload-cloud-fill" style\x3d"display:block"\x3e\x3c/label\x3e')});d(document).on("click","ks-pic-thumb \x3e span[icon*\x3ddelete]",function(){var a=d(this),b=a.attr("delapi");d.Dialog("confirm","\u64cd\u4f5c\u63d0\u793a","\u786e\u8ba4\u8981\u5220\u9664\u8be5\u6587\u4ef6\u5417\uff1f",function(){b?d.API(b,"",function(c){a.parent().parent().nextAll("ks-pic").show();c.success&&a.parent().parent().remove()}):(a.parent().parent().nextAll("ks-pic").show(),a.parent().parent().remove())})});d.render("ks-star",function(a){a=d(a);var b=a.attr(),c=parseInt(b.value||0),e="";d.loop(parseInt(b.max||5),function(a){e+='\x3ci icon\x3d"star-fill" '+(c==a?"active":"")+"\x3e\x3c/i\x3e"});a.html(e)},"attr.value");d.render(".ks-slide",function(a){a=d(a);var b=a.attr();a.slide({auto:b.auto,card:b.card,control:b.control,status:b.status})});d.render("table.ks-table",function(a){},"html");d.render("table.ks-table[fixed-height]",function(a){a=d(a);var b=parseInt(a.attr("fixed-height"))||0;if(b){a.attr("fixed-height","");var c=a.children("thead"),e=a.width(!0),b=d('\x3cdiv class\x3d"ks-table-fixed-header"\x3e\x3cdiv class\x3d"ks-table-header"\x3e\x3c/div\x3e\x3cdiv class\x3d"ks-table-body" style\x3d"overflow-y: scroll; max-height:'+b+'px"\x3e\x3c/div\x3e\x3c/div\x3e'),f=a.children().eq(0).children().children(),g=f.length-1,k="\x3ccolgroup\x3e";f.each(function(a,c){if(a!==g){var b=d(c).width(!0)/e*100;k+='\x3ccol style\x3d"width:'+b+"%; min-width: "+b+'%"\x3e'}});k+="\x3c/colgroup\x3e";a.after(b);b.find(".ks-table-header").html('\x3ctable class\x3d"'+a.attr("class")+'"\x3e'+k+"\x3c/table\x3e").find("table").append(c);b.find(".ks-table-body").append(a[0]).find("table").prepend(k);a=b.find(".ks-table-body").width(!0)-b.find(".ks-table-body \x3e table").width(!0);c=document.createElement("td");c.style.width=a+"px";c.className="ks-td-scroll";b.find(".ks-table-header \x3e table \x3e thead \x3e tr").append(c)}});d.render("ks-form",function(a){a=d(a);var b=d.isset(a.attr("inline")),c=a.attr("label-width");a.find("ks-form-item").map(function(a){if(!a._ksa_render_ks_form_item){a._ksa_render_ks_form_item=1;a=d(a);var e=a.attr();!b&&a.addClass("ks-clear");a.wrapInner("\x3cks-form-content\x3e\x3c/ks-form-content\x3e");e.label&&a.prepend("\x3cks-form-label "+(d.isset(e.required)?"required":"")+"\x3e"+e.label+"\x3c/ks-form-label\x3e");e.extra&&a.append("\x3cks-form-extra\x3e"+e.extra+"\x3c/ks-form-extra\x3e");a.attr({label:"",extra:"",required:""});c&&(c=d.isNumber(c)?c+"px":c,a.find("ks-form-label").width(c),a.find("ks-form-content , ks-form-extra").width("calc(100% - "+c+")"))}})});d.render("ks-btn[submit]",function(a){a=d(a);var b=a.attr("submit"),c=b?d(b):a.parents("form");c.length&&(a.click(function(){!a.disabled()&&c.submit()}),c.keyup(function(a){13==a.keyCode&&c.submit()}))});d.render("ks-btn[reset]",function(a){a=d(a);var b=a.attr("reset");a.attr("reset","");var c=b?d(b):a.parents("form");c.length||(c=a.parents("ks-form"));c.length&&a.click(function(){c.find('input:not([type\x3d"hidden"]), select, textarea').val("");c.find("select").attr("value","")})});d.render("ks-collapse",function(a){d(a).children().map(function(a){a=d(a);var c=a.attr();a.wrapInner("\x3cks-collapse-block\x3e\x3c/ks-collapse-block\x3e").wrapInner("\x3cks-collapse-content\x3e\x3c/ks-collapse-content\x3e");a.prepend("\x3cks-collapse-title\x3e"+(c.label||"")+"\x3c/ks-collapse-title\x3e");var c=a.parent(),b=d.isset(c.attr("accordion")),f=a.children("ks-collapse-content");a.active()&&f.height(f.children("ks-collapse-block").height(!0,!0));a.children("ks-collapse-title").click(function(){var c=f.children("ks-collapse-block").height(!0,!0);if(a.active())f.height(0),a.active(!1);else if(f.height(c),a.active(!0),c=b?a.siblings():!1)c.active(!1),c.children("ks-collapse-content").height(0)})})});d.render("ks-price",function(a){function b(c){var b=a.contents();c=c?c:b.eq(0).text().trim();c=c.toString();b.map(function(){this.textContent=""});b.nextAll("",1).remove();c=c.replace(/([^\s0-9\.]+)/gi,"\x3cunit\x3e$1\x3c/unit\x3e");c=c.replace(/(\.[0-9]+)/g,"\x3csmall\x3e$1\x3c/small\x3e");d.isset(a.attr("split"))&&(c=c.replace(/([0-9]+)\.?/,function(a){a=a.replace(/([0-9])([0-9]{3})$/g,"$1,$2");return""+a+""}));a.append(c)}a=d(a);var c=a.attr("value"),e=a.attr("unit");e&&(c=e+c);b(c);a.DOMchange("attr.value",function(a){b(a)})},"attr.value attr.unit");d.render("ks-card",function(a,b){a=d(a);var c=a.attr(),e=a.children("ks-card-title");a.children("ks-card-content").length||(a.wrapInner("\x3cks-card-content\x3e\x3c/ks-card-content\x3e"),e.length&&a.prepend(e));e.length?b&&(c.label?e.html(c.label):e.remove()):c.label&&a.prepend(d.tag("ks-card-title",{icon:c.icon},d.tag("div",{"class":"ks-fl"},c.label)))},"attr.label");d.render("ks-alert",function(a){a=d(a);var b=a.attr(),c=d.isset(b.close),e="";b.title&&(e+="\x3cks-alert-title\x3e"+b.title+"\x3c/ks-alert-title\x3e");c&&(e+='\x3cks-alert-close icon\x3d"close"\x3e\x3c/ks-alert-close\x3e');a.prepend(e);a.attr("title","");c&&a.children("ks-alert-close").click(function(){a.css("opacity","0");window.setTimeout(function(){a.remove()},300)})});d.render("ks-avatar",function(a){a=d(a);var b=a.attr(),c=b.label&&!b.src?b.label:null;a.html(c?c:b.src?'\x3cimg src\x3d"'+b.src+'"\x3e':'\x3ci icon\x3d"user"\x3e\x3c/i\x3e')},"attr.label attr.src");d.render("ks-page",function(a){function b(b,e){if(!a.disabled()&&b!=a[0].value){"prev"===b?(b=a[0].value-1,b=1>b?1:b):"next"===b&&(b=a[0].value+1,b=b>c?c:b);b=parseInt(b);a.children("ks-page-prev").disabled(1===b);a.children("ks-page-first").disabled(b<f/2);a.children("ks-page-next").disabled(b===c);a.children("ks-page-last").disabled(b>c-f/2);a.attr("current",b);a[0].value=b;var g=b-(f-1)/2,h=c-f+1,g=g>h?h:g,g=1>g?1:g;a.children("a").map(function(a){d(a).attr("value",g).text(g);g++});a.children('a[value\x3d"'+b+'"]').active(!0).siblings("a").active(!1);a.find(".ks-input-group \x3e input").val(b);!e&&a.trigger("change")}}a=d(a);var c=parseInt(a.attr("total")||0);if(c){var e=parseInt(a.attr("current")||1),f=parseInt(a.attr("numbers")||5),g=a.attr("href"),k="";(function(){var a=Math.ceil(e-(f-1)/2),a=1>a?1:a,b=Math.min(c+1,a+f);if(!(2>=b))for(;a<b;a++)k+=d.tag("a",{active:e===a?!0:null,value:a,href:g?g.replace("{{page}}",val):null},a)})();if(k){var h;h='\x3cks-page-first icon\x3d"arrow-left" value\x3d"1"\x3e\x3c/ks-page-first\x3e\x3cks-page-prev icon\x3d"arrow-left-s" value\x3d"prev"\x3e\x3c/ks-page-prev\x3e'+k+('\x3cks-page-next icon\x3d"arrow-right-s" value\x3d"next"\x3e\x3c/ks-page-next\x3e\x3cks-page-last icon\x3d"arrow-right" value\x3d"'+c+'"\x3e\x3c/ks-page-last\x3e');d.isset(a.attr("quick"))&&(h+='\x3cks-input-group\x3e\x3ci\x3e\u8f6c\x3c/i\x3e\x3cinput type\x3d"text" value\x3d"'+e+'"\x3e\x3ci\x3e\u9875\x3c/i\x3e\x3c/ks-input-group\x3e');a.html(h);b(e,!0);a.children("*:not(ks-input-group)").click(function(){var a=d(this);a.disabled()||b(a.attr("value"))});a.find("ks-input-group \x3e input").keyup(function(a){13===a.keyCode&&b(this.value)}).focus(function(){d(this).select()})}}},"attr.total attr.current");d.render("ks",function(a){a=d(a);a.children("ks-side").length&&a.css("flex-direction","row")});d.render("ks-navbar",function(a){a=d(a);var b=a.parent("ks");b.attr("navbar",!0);a=a.children("ks-navbar-item");var c=b.children("ks-content").children("ks-navbar-content");a.each(function(a,b){b=d(b);var e=b.attr("href");e&&b.click(function(){window.location.href=e});var f=b.attr("key");b.active()&&c.filter('[key\x3d"'+f+'"]').show().siblings().hide();b.click(function(){d(this).active(!0)}).DOMchange("attr.active",function(){var a=d(this);a.active()&&(a.siblings().active(!1),c.filter('[key\x3d"'+f+'"]').show().siblings().hide())})})});d.render("ks-row",function(a){a=d(a);a.children("ks-col").length&&a.attr("flex",!0)});d.render("ks-tab",function(a){function b(a){g.eq(0<=a?a:0).active(!0).siblings().active(!1)}function c(a){a=parseInt(a||0);q=0-p*a;e?k.removeClass("ks-no-transition").css({transform:"translateX("+q+"px)"}):h.eq(a).show().active(!0).siblings().hide().active(!1)}a=d(a);var e=d.isset(a.attr("touch")),f=a.children("ks-tab-title"),g=f.children("ks-tab-title-item"),k=a.children("ks-tab-content"),h=a.find("ks-tab-item"),m=h.length;f.length||(f=d("\x3cks-tab-title\x3e\x3c/ks-tab-title\x3e"),h.each(function(a,b){b=d(b);f.append(d.tag("ks-tab-title-item",{active:b.active()},b.attr("label")||a))}),a.prepend(f),g=f.children("ks-tab-title-item"));k.length||(h.wrapAll("\x3cks-tab-content\x3e\x3c/ks-tab-content\x3e"),k=a.children("ks-tab-content"));var l=g.filter("[active]").index()||0,q=0,p=a.width(!0),n=m*p;k.addClass("ks-clear");g.click(function(){d(this).active()||b(d(this).index())}).DOMchange("attr.active",function(){var a=d(this);a.active()&&(a=a.index(),c(a))});e&&(k.wrap("\x3cks-tab-touch-content\x3e\x3c/ks-tab-touch-content\x3e"),k.width(n),h.width(p),a.children("ks-tab-touch-content").touch(function(){},function(a,b){if("left"===b.action||"right"===b.action){var c=q+b.moveX,d=0-(n-p),c=0<c?0:c<d?d:c;k.addClass("ks-no-transition").css({transform:"translateX("+c+"px)"})}},function(a,b){l<m-1&&"left"==b.action?(l++,g.eq(l).trigger("click")):0<l&&"right"==b.action?(l--,g.eq(l).trigger("click")):k.removeClass("ks-no-transition").css({transform:"translateX("+q+"px)"})},"X"));c(l);b(l)},"html");d.render("ks-tag[close], ks-tag[edit]",function(a){a=d(a);var b=a.attr();a.wrapInner("\x3cspan\x3e\x3c/span\x3e");if(b.edit){var c=d('\x3cinput type\x3d"hidden" value\x3d"'+a.text()+'"\x3e');c.blur(function(){var e=c.val();c.attr("type","hidden");c.prev().css("opacity","").text(e);d.callStrEvent.call(a[0],b.edit,e)});a.append(c);a.click(function(){c.prev().css("opacity","0");c.attr("type","text").focus().select()})}if(d.isset(b.close)){var e=d('\x3ci icon\x3d"close"\x3e\x3c/i\x3e');e.click(function(c){var e;b.close&&(e=d.callStrEvent.call(a[0],b.close,c));!1!==e&&a.remove();return!1});a.append(e)}});d.render("[title]",function(a){a=d(a);var b=a.attr("title");b&&a.hover(function(){d.showTip(a);a.attr("title","")},function(){a.attr("title",b)})});d.render("[icon]",function(a){var b=a.attributes.icon.value,c=[];d.loop(a.classList,function(a){-1===a.indexOf("ri-")&&c.push(a)});b&&c.push(" ri-"+b);a.className=d.implode(" ",c)},"attr.icon")})();(function(){function a(a,b,c,k){b._KSAUIRENDER_||(b._KSAUIRENDER_={});a.monitor.length&&d.loop(a.monitor,function(c){var d;"attributes"===k.type?d=c=="attr."+k.attributeName?k.attributeName:null:"html"==c&&"childList"===k.type&&(d=c);d&&a.callback&&a.callback.call(b,b,!0,c)});b._KSAUIRENDER_[c]||(b._KSAUIRENDER_[c]=!0,a.callback&&a.callback.call(b,b))}function b(b,c){1===b.nodeType&&(b=d(b),d.loop(d.ksauiRenderTree,function(d,e){b.find(e).map(function(b){a(d,b,e,c)});var f=b.filter(e);f.length&&a(d,f[0],e,c)}))}var c=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;if(c)(new c(function(a){d.loop(a,function(a){"childList"===a.type&&a.addedNodes.length?d.loop(a.addedNodes,function(c){1===c.nodeType&&d.isIndom(c)&&b(c,a)}):"attributes"===a.type&&b(a.target,a)})})).observe(document,{characterDataOldValue:!0,attributeOldValue:!0,attributes:!0,childList:!0,subtree:!0});else d(document).on("DOMContentLoaded DOMNodeInserted",function(a){"DOMNodeInserted"===a.type?b(a.target):d.loop(document.body.children,function(a){b(a)})})})()})(KSA);